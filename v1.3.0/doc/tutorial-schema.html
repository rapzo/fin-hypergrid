<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Tutorial: schema</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-defaults.html">defaults</a></li><li><a href="module-dynamicProperties.html">dynamicProperties</a></li><li><a href="module-effects.html">effects</a></li><li><a href="module-fields.html">fields</a></li><li><a href="module-images.html">images</a></li><li><a href="module-localization.html">localization</a></li><li><a href="module-src_behaviors_cellProperties.html">src/behaviors/cellProperties</a></li></ul><h3>Classes</h3><ul><li><a href="AggregationsView.html">AggregationsView</a></li><li><a href="Base.html">Base</a></li><li><a href="Behavior.html">Behavior</a></li><li><a href="behaviors.JSON.html">JSON</a></li><li><a href="Button.html">Button</a></li><li><a href="CellClick.html">CellClick</a></li><li><a href="CellEditing.html">CellEditing</a></li><li><a href="CellEditor.html">CellEditor</a></li><li><a href="CellEditors.html">CellEditors</a></li><li><a href="CellRenderer.html">CellRenderer</a></li><li><a href="CellRenderers.html">CellRenderers</a></li><li><a href="CellSelection.html">CellSelection</a></li><li><a href="Color.html">Color</a></li><li><a href="Column.html">Column</a></li><li><a href="ColumnMoving.html">ColumnMoving</a></li><li><a href="ColumnPicker.html">ColumnPicker</a></li><li><a href="ColumnResizing.html">ColumnResizing</a></li><li><a href="ColumnSchemaFactory.html">ColumnSchemaFactory</a></li><li><a href="ColumnSelection.html">ColumnSelection</a></li><li><a href="ColumnSorting.html">ColumnSorting</a></li><li><a href="Combo.html">Combo</a></li><li><a href="ComboBox.html">ComboBox</a></li><li><a href="DataModel.html">DataModel</a></li><li><a href="dataModels.JSON.html">JSON</a></li><li><a href="DataSourceOrigin.html">DataSourceOrigin</a></li><li><a href="Date.html">Date</a></li><li><a href="DefaultFilter.html">DefaultFilter</a></li><li><a href="Dialog.html">Dialog</a></li><li><a href="DialogUI.html">DialogUI</a></li><li><a href="ErrorCell.html">ErrorCell</a></li><li><a href="factory-CellEvent.html">CellEvent</a></li><li><a href="Feature.html">Feature</a></li><li><a href="FilterBox.html">FilterBox</a></li><li><a href="Filters.html">Filters</a></li><li><a href="FilterSubgrid.html">FilterSubgrid</a></li><li><a href="groupedHeader.mixInTo-GroupedHeader.html">GroupedHeader</a></li><li><a href="GroupView.html">GroupView</a></li><li><a href="HeaderSubgrid.html">HeaderSubgrid</a></li><li><a href="Hyperfilter.html">Hyperfilter</a></li><li><a href="Hypergrid.html">Hypergrid</a></li><li><a href="KeyPaging.html">KeyPaging</a></li><li><a href="LastSelection.html">LastSelection</a></li><li><a href="ManageFilters.html">ManageFilters</a></li><li><a href="module-localization-DateFormatter.html">DateFormatter</a></li><li><a href="module-localization-Formatter.html">Formatter</a></li><li><a href="module-localization-Localization.html">Localization</a></li><li><a href="module-localization-NumberFormatter.html">NumberFormatter</a></li><li><a href="Number.html">Number</a></li><li><a href="OnHover.html">OnHover</a></li><li><a href="ParserCQL.html">ParserCQL</a></li><li><a href="Renderer.html">Renderer</a></li><li><a href="RowResizing.html">RowResizing</a></li><li><a href="RowSelection.html">RowSelection</a></li><li><a href="SelectionModel.html">SelectionModel</a></li><li><a href="SimpleCell.html">SimpleCell</a></li><li><a href="Slider.html">Slider</a></li><li><a href="SparkBar.html">SparkBar</a></li><li><a href="SparkLine.html">SparkLine</a></li><li><a href="Spinner.html">Spinner</a></li><li><a href="SummarySubgrid.html">SummarySubgrid</a></li><li><a href="Textfield.html">Textfield</a></li><li><a href="ThumbwheelScrolling.html">ThumbwheelScrolling</a></li><li><a href="TreeCell.html">TreeCell</a></li><li><a href="TreeView.html">TreeView</a></li><li><a href="WritablePoint.html">WritablePoint</a></li></ul><h3>Mixins</h3><ul><li><a href="drillDown.html">drillDown</a></li><li><a href="groupedHeader.html">groupedHeader</a></li><li><a href="rowById.html">rowById</a></li></ul><h3>Interfaces</h3><ul><li><a href="dataControlInterface.html">dataControlInterface</a></li><li><a href="dataModelAPI.html">dataModelAPI</a></li><li><a href="localizerInterface.html">localizerInterface</a></li></ul><h3>Global</h3><ul><li><a href="global.html#append">append</a></li><li><a href="global.html#cancelEditing">cancelEditing</a></li><li><a href="global.html#close">close</a></li><li><a href="global.html#computeCellsBounds">computeCellsBounds</a></li><li><a href="global.html#copy">copy</a></li><li><a href="global.html#copyAll">copyAll</a></li><li><a href="global.html#deprecated">deprecated</a></li><li><a href="global.html#dispatchEvent">dispatchEvent</a></li><li><a href="global.html#errorEffectEnd">errorEffectEnd</a></li><li><a href="global.html#factory">factory</a></li><li><a href="global.html#findCell">findCell</a></li><li><a href="global.html#getActiveColumns">getActiveColumns</a></li><li><a href="global.html#getColumns">getColumns</a></li><li><a href="global.html#getTextWidthTruncated">getTextWidthTruncated</a></li><li><a href="global.html#handleKeyDown">handleKeyDown</a></li><li><a href="global.html#hideEditor">hideEditor</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#modes">modes</a></li><li><a href="global.html#onClick">onClick</a></li><li><a href="global.html#open">open</a></li><li><a href="global.html#rebundleGridRenderers">rebundleGridRenderers</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resetCellPropertiesCache">resetCellPropertiesCache</a></li><li><a href="global.html#saveFolder">saveFolder</a></li><li><a href="global.html#saveFolders">saveFolders</a></li><li><a href="global.html#setColumnFilterState">setColumnFilterState</a></li><li><a href="global.html#validateEditorValue">validateEditorValue</a></li><li><a href="global.html#valOrFunc">valOrFunc</a></li><li><a href="global.html#visibleColumns">visibleColumns</a></li><li><a href="global.html#visibleRows">visibleRows</a></li></ul>
</nav>
<div id="main">

    <h1 class="page-title">Tutorial: schema</h1>

    <section>

<header>
    

    <h2>schema</h2>
</header>

<article>
    <p>Filter-tree does require a schema to function. There are several options for this I will discuss below.</p>
<p>In keeping with our new Hypergrid architecture goals, we plan very soon to &quot;deconstruct&quot; the Hypergrid instantiation. The &quot;options&quot; approach was intended to simplify instantiation to get up and running quickly but seems instead to have confused people by hiding the mechanics (so they don't really understand what's going on) and forcing them to do things in a certain (limited) way. (It was also a work-around for the chicken-or-egg problem of referencing the data source's fields array which doesn't exist yet, because the behavior doesn't exist yet, because the grid doesn't exist yet...)</p>
<p>So in the future, if you want filtering, you will instantiate your filter separately and point the grid at it. (Could be filter-tree or some other filter API.) If you don't there will simply be no filter row.</p>
<p>But for now, as you must supply a schema, but it's pretty easy. Let's consider the available solutions:</p>
<h4>Simple solution</h4><p>The schema can be as simple as a list of fields:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = [ 'item', 'price', ... ];</code></pre><p>List all the columns you want the filter to be aware of. The order of this list can be arbitrary. (Unlike the behavior.columns array, the filter's column schema's order does not need to match the data source's fields array. This is because the filter accesses columns only by name, not index.)</p>
<p>Even simpler solution. If you don't have a schema prepared, even simpler might be to just use the data source's fields array. This is a bit of a chicken-or-egg problem because the data source doesn't exist yet (because the behavior doesn't exist yet (because the grid doesn't exist yet...)). An easy way to work around this is to set the schema to a callback function (called with behavior as &quot;this&quot; context):</p>
<pre class="prettyprint source lang-javascript"><code>var schema = function() {
    return this.dataModel.getFields();
}</code></pre><h4>Columns array</h4><p>Or you could derive the schema from the behavior.columns array which has (inferred) type information. For convenience the callback is called with the array as its first parameter (even though it is readily available as this.columns):</p>
<pre class="prettyprint source lang-javascript"><code>var schema = function(columns) {
    return columns.map(function(column) {
    return {
        name: column.name,
        alias: column.header,
        type: column.getType()
    };

};}</code></pre><h4>ColumnSchemaFactory</h4><p>Deriving the schema from the behavior.columns array is precisely the idea behind the ColumnSchemaFactory! Despite it's fancy name, if you look in ColumnSchemaFactory.js, all it is doing is looping through behavior.columns as shown above! (It also offers some methods for organizing the schema into a hierarchy, sorting it, etc., but those are just extras and you don't have to use these methods.) So the above becomes even easier:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = function(columns) {
    return new fin.Hypergrid.ColumnSchemaFactory(columns).schema;
}</code></pre><h4>Persisted schema</h4><p>Probably the best approach is a robust custom schema which you can persist on your data store, including headers and types when you know them:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = [
    { name: 'item', header: 'Description' },
    { name: 'price', header: 'Unit Cost', type: 'number' }
];</code></pre><p>You can also supply some filter options such as a default operator or an operator list:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = [
    { name: 'item', header: 'Description', defaultOp: 'contains' },
    { name: 'price', header: 'Unit Cost', type: 'number', opMenu = ['>', '&lt;'] }
];</code></pre><p>Nested schema. The list can include a hierarchy which the filter can use to show the columns organized into folders, such as the way filter-tree renders its Qurery Builder drop-downs:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = ['item', [ 'wholesale', 'MSRP' ] ];</code></pre><p>To give the nested group a name:</p>
<pre class="prettyprint source lang-javascript"><code>var pricing = [ 'wholesale', 'MSRP' ];
pricing.label = 'Pricing';
var schema = ['item', pricing ];</code></pre><p>Or:</p>
<pre class="prettyprint source lang-javascript"><code>var schema = [
    'item',
    {
        label: 'Pricing',
        submenu: [ 'wholesale', 'MSRP' ]
    }
];</code></pre><p>Caveat: Be aware that most browsers only render one level of nesting in drop-downs.</p>
</article>

</section>

</div>

<br class="clear">

<footer>
    © 2017 <a href="http://www.openfin.co" target="_blank">OpenFin</a> All Rights Reserved.
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>